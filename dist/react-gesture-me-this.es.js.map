{"version":3,"file":"react-gesture-me-this.es.js","sources":["../node_modules/gesture-me-this/dist/gesture-me-this.es.js","../src/index.ts"],"sourcesContent":["class r {\n  constructor(t, i) {\n    this.x = t, this.y = i;\n  }\n  add(t, i = new r(0, 0)) {\n    return i.x = this.x + t.x, i.y = this.y + t.y, i;\n  }\n  add_assign(t) {\n    return this.add(t, this);\n  }\n  sub(t, i = new r(0, 0)) {\n    return i.x = this.x - t.x, i.y = this.y - t.y, i;\n  }\n  sub_assign(t) {\n    return this.sub(t, this);\n  }\n  mul(t, i = new r(0, 0)) {\n    return i.x = this.x * t, i.y = this.y * t, i;\n  }\n  mul_assign(t) {\n    return this.mul(t, this);\n  }\n  div(t, i = new r(0, 0)) {\n    return this.mul(1 / t, i);\n  }\n  div_assign(t) {\n    return this.mul_assign(1 / t);\n  }\n  neg(t = new r(0, 0)) {\n    return this.mul(-1, t);\n  }\n  neg_assign() {\n    return this.mul_assign(-1);\n  }\n  dot(t) {\n    return this.x * t.x + this.y * t.y;\n  }\n  cross(t) {\n    return this.x * t.y - this.y * t.x;\n  }\n  length_sq() {\n    return this.dot(this);\n  }\n  length() {\n    return Math.sqrt(this.length_sq());\n  }\n  normalise(t = new r(0, 0)) {\n    return this.mul(1 / this.length(), t);\n  }\n  normalise_assign() {\n    return this.mul_assign(1 / this.length());\n  }\n  copy_from(t) {\n    return this.x = t.x, this.y = t.y, this;\n  }\n  set(t, i) {\n    this.x = t, this.y = i;\n  }\n}\nclass m {\n  constructor() {\n    this.finger_count = 0, this.fingers = /* @__PURE__ */ new Map(), this.centroid = new r(0, 0);\n  }\n  // average_finger_direction(): Vector {\n  //   const average_direction = new Vector(0, 0);\n  //   if (this.finger_count > 1) {\n  //     for (const finger of this.fingers.values()) {\n  //       average_direction.add_assign(finger.position_delta);\n  //     }\n  //     average_direction.div_assign(this.finger_count);\n  //   }\n  //   return average_direction;\n  // }\n}\nclass f {\n  constructor(t, i) {\n    this.position_delta = new r(0, 0), this.centroid_direction = new r(0, 0), this.position = new r(t, i);\n  }\n  is_moving_toward_centroid() {\n    return this.position_delta.dot(this.centroid_direction) > 0;\n  }\n  /** Returns the angle around `point` that the finger moved in radians  */\n  angle_delta_around_point(t) {\n    const i = this.position.sub(this.position_delta).sub_assign(t).normalise_assign(), e = this.position.sub(t).normalise_assign();\n    return Math.acos(i.dot(e));\n  }\n}\nclass w {\n  constructor(t, i) {\n    this.element = t, this.metrics = new m();\n    const e = (s) => {\n      var o;\n      s.preventDefault(), this.initialise_touches(s.changedTouches), (o = i.on_start) == null || o.call(i, this.metrics, s);\n    }, c = (s) => {\n      var o;\n      s.preventDefault(), this.update_touches(s.changedTouches), (o = i.on_move) == null || o.call(i, this.metrics, s);\n    }, u = (s) => {\n      var o;\n      s.preventDefault(), this.remove_touches(s.changedTouches), (o = i.on_end) == null || o.call(i, this.metrics, s);\n    }, _ = (s) => {\n      var o;\n      s.preventDefault(), this.remove_all_touches(), (o = i.on_cancel) == null || o.call(i, this.metrics, s);\n    };\n    t.addEventListener(\"touchstart\", e), t.addEventListener(\"touchmove\", c), t.addEventListener(\"touchend\", u), t.addEventListener(\"touchcancel\", _), this.on_start = e, this.on_move = c, this.on_end = u, this.on_cancel = _;\n  }\n  /** Removes the touch event listeners from the element */\n  disableGestures() {\n    this.element.removeEventListener(\"touchstart\", this.on_start), this.element.removeEventListener(\"touchmove\", this.on_move), this.element.removeEventListener(\"touchmove\", this.on_end), this.element.removeEventListener(\"touchmove\", this.on_cancel);\n  }\n  initialise_touches(t) {\n    this.metrics.finger_count += t.length;\n    for (const i of t) {\n      const e = new f(i.clientX, i.clientY);\n      this.metrics.fingers.set(i.identifier, e);\n    }\n    this.calculate_centroid();\n  }\n  update_touches(t) {\n    for (const i of t) {\n      const e = this.metrics.fingers.get(i.identifier);\n      e && (e.position_delta.set(\n        i.clientX - e.position.x,\n        i.clientY - e.position.y\n      ), e.position.set(i.clientX, i.clientY));\n    }\n    this.calculate_centroid();\n  }\n  remove_touches(t) {\n    this.metrics.finger_count -= t.length;\n    for (const i of t)\n      this.metrics.fingers.delete(i.identifier);\n    this.calculate_centroid();\n  }\n  remove_all_touches() {\n    this.metrics.finger_count = 0, this.metrics.fingers.clear(), this.metrics.centroid.set(0, 0);\n  }\n  calculate_centroid() {\n    const { finger_count: t, fingers: i, centroid: e } = this.metrics;\n    e.set(0, 0);\n    for (const c of i.values())\n      e.add_assign(c.position);\n    t > 1 && e.div_assign(t);\n    for (const c of i.values())\n      e.sub(c.position, c.centroid_direction);\n  }\n}\nvar v = /* @__PURE__ */ ((n) => (n[n.Inward = 0] = \"Inward\", n[n.Outward = 1] = \"Outward\", n))(v || {});\nconst p = {\n  sensitivity: 0.5\n}, x = (n, t) => {\n  const { exact_finger_count: i, sensitivity: e = 0.5 } = t ?? p, c = !!i && n.finger_count === i || !i && n.finger_count > 1;\n  let u;\n  if (c) {\n    const _ = n.fingers.values();\n    let { value: s, done: o } = _.next(), l = s.is_moving_toward_centroid(), a = !0;\n    for (; !o && a; )\n      a = l === s.is_moving_toward_centroid(), { value: s, done: o } = _.next();\n    if (a) {\n      const g = l ? 0 : 1;\n      let h = 0;\n      for (const d of n.fingers.values())\n        h += d.position_delta.length();\n      h /= n.finger_count, h *= e, u = { strength: h, direction: g };\n    }\n  }\n  return u ? { is_recognised: !0, metrics: u } : { is_recognised: !1 };\n};\nexport {\n  f as Finger,\n  w as GestureController,\n  m as Metrics,\n  v as PinchDirection,\n  r as Vector,\n  x as pinch_zoom\n};\n//# sourceMappingURL=gesture-me-this.es.js.map\n","import React from \"react\";\nimport {\n  GestureController,\n  PinchMetrics,\n  TouchHandlers,\n  pinch_zoom,\n} from \"gesture-me-this\";\n\nexport type GestureHandlers = {\n  onPinch?(metrics: PinchMetrics): void;\n};\n\nexport function useGestures(handlers: GestureHandlers): React.Ref<HTMLElement> {\n  const ref = React.useRef(null);\n  let controller: GestureController | undefined;\n\n  React.useEffect(() => {\n    if (ref.current) {\n      const touchHandlers: TouchHandlers = {};\n\n      if (handlers.onPinch) {\n        touchHandlers.on_move = (metrics) => {\n          const result = pinch_zoom(metrics);\n          if (result.is_recognised) {\n            handlers.onPinch?.(result.metrics);\n          }\n        };\n      }\n\n      controller = new GestureController(ref.current, touchHandlers);\n    }\n\n    return () => {\n      controller?.disableGestures();\n    };\n  }, [ref]);\n\n  return ref;\n}\n"],"names":["r","i","m","f","e","w","s","o","c","u","_","p","x","n","l","g","h","d","useGestures","handlers","ref","React","controller","touchHandlers","metrics","result","pinch_zoom","_a","GestureController"],"mappings":"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","x_google_ignoreList":[0]}